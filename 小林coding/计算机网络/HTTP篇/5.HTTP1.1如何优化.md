### 如何避免发送HTTP请求

要避免发送不必要的 HTTP 请求，核心思路是利用 **HTTP 的缓存机制**。这主要通过两种方式实现：**强制缓存**和**协商缓存**。

1.  **强制缓存 (Strong Cache)**
    * 这是最理想的方式，**完全不需要向服务器发送请求**。
    * 服务器在第一次响应时，通过响应头（如 `Cache-Control: max-age=3600`）告诉浏览器，这个资源在 3600 秒内是有效的。
    * 在此有效期内，浏览器如果再次请求该资源，会直接从本地磁盘读取缓存副本，不会产生任何网络请求，速度最快。

2.  **协商缓存 (Negotiation Cache / Revalidation)**
    * 当强制缓存过期后，浏览器**必须向服务器发送一个请求**来“协商”一下，确认本地缓存是否还能用。
    * 浏览器在请求头里会带上上次响应中的唯一标识（如 `ETag`）。
    * 服务器收到后，会比较这个标识与服务器上最新资源的标识：
        * **如果标识一致**，说明资源未改变。服务器会返回一个 **`304 Not Modified`** 响应，这个响应**没有包体**，只告诉浏览器“你的缓存还能用”。这样就避免了重新下载整个资源的开销。
        * **如果标识不一致**，说明资源已更新。服务器会返回 `200 OK` 和最新的资源数据。

**总结一下：** 性能优化的首选是**强制缓存**，它能彻底避免网络请求。当强制缓存失效后，再通过**协商缓存**，用一个极小的请求来验证本地副本是否仍然有效，从而最大限度地减少网络传输的数据量。

### 如何减少 HTTP 请求次数？

主要有三种策略可以有效减少 HTTP 请求的次数，从而提升加载性能：

1.  **合并请求 (Combine Requests)**
    * 将多个小文件合并成一个大文件，用一次请求代替多次请求。
    * **具体方法**：
        * **CSS Sprites**：将多个小图标、背景图合并成一张大雪碧图，通过 CSS 背景定位来显示。
        * **打包工具**：使用 Webpack 等工具将多个 JavaScript 或 CSS 文件打包成一个文件。
        * **Base64 编码**：将小图片编码成 Base64 字符串，直接嵌入到 HTML 或 CSS 文件中，从而无需单独请求图片。

2.  **延迟发送请求 (Lazy Loading)**
    * 对于非首屏必需的资源，推迟其加载时机，实现“按需加载”。
    * **具体方法**：
        * **图片懒加载**：只加载可视区域内的图片，当用户滚动到相应位置时再加载下方的图片。
        * **路由/组件懒加载**：在单页应用 (SPA) 中，只在访问特定路由时才加载对应的组件和资源。

3.  **减少重定向 (Reduce Redirects)**
    * 重定向会产生额外的网络请求，应尽量避免。
    * **具体方法**：
        * 确保链接地址是最终地址，避免中间跳转。
        * 如果必须重定向，优先使用 **301 (永久重定向)**，因为浏览器可以缓存这个结果，下次访问时会直接请求新地址，从而避免了重定向请求。

### 如何减少 HTTP 响应的数据大小？

减小响应数据的大小可以直接降低传输时间和带宽消耗，主要通过对资源进行压缩实现，分为两种：

1.  **无损压缩 (Lossless Compression)**
    * **适用对象**：文本文件，如 HTML、CSS、JavaScript。
    * **特点**：压缩后可以 100% 恢复原始数据，不会损失任何信息。
    * **工作方式**：客户端通过请求头 `Accept-Encoding` 告知服务器支持的压缩算法（如 `gzip`, `br`），服务器选择一种进行压缩，并通过响应头 `Content-Encoding` 告知客户端。目前 **Brotli (`br`)** 的压缩率通常优于 `gzip`。

2.  **有损压缩 (Lossy Compression)**
    * **适用对象**：多媒体文件，如图片、音频、视频。
    * **特点**：牺牲部分质量来换取极高的压缩率。
    * **具体方法**：
        * **图片**：使用更现代、压缩效率更高的格式，如 **WebP** 代替传统的 JPEG/PNG。
        * **视频/音频**：采用先进的编码格式（如视频的 H.264/H.265），利用关键帧和增量数据来大幅减少数据量。