### 案例背景

**项目名称：** 我的个人博客网站 (`my-blog`)
**当前状态：** 网站已经有一个主页 (`index.html`)，并且已经上线。这个主页在 `main` 分支上。
**新任务：** 我们需要为博客网站增加一个“关于我” (`about.html`) 的页面。

**核心原则：** 我们不能在 `main` 分支上直接开发新功能。因为 `main` 分支代表的是稳定、可随时发布的代码。如果我们在上面直接修改，改到一半的时候有紧急 Bug 需要修复，整个分支就会变得一团糟。所以，最佳实践是为新功能创建一个专门的分支。

### 准备工作：创建项目

如果你想亲手跟着做，可以打开你的终端或命令行工具，按以下步骤操作。

```bash
# 1. 创建一个项目文件夹
mkdir my-blog
cd my-blog

# 2. 初始化 Git 仓库
git init

# 3. 创建主页文件
echo "欢迎来到我的博客" > index.html

# 4. 将主页文件添加到 Git 并提交
git add index.html
git commit -m "Initial commit: Add homepage"
```

现在，我们的项目准备好了。它只有一个 `main` 分支，包含一个 `index.html` 文件。

-----

### 详细步骤与命令解析

#### 第 1 步：查看当前分支 (`git branch`)

在开始任何工作前，先看看我们现在在哪。

```bash
git branch
```

**输出：**

```
* main
```

  * `git branch` 命令会列出你本地仓库中所有的分支。
  * 分支名前面的星号 `*` 表示你当前所在的分支。这里我们在 `main` 分支上。

#### 第 2 步：为新功能创建分支 (`git branch <branch-name>`)

我们要开发“关于我”页面，所以我们创建一个名为 `feature/about-page` 的新分支。（使用 `feature/` 前缀是组织分支的好习惯）。

```bash
git branch feature/about-page
```

这个命令**仅仅是创建**了一个新的分支，它就像是给当前我们所在的 commit（即 `main` 分支最新的 commit）贴上了一个新的标签 `feature/about-page`。

**我们现在再次查看分支：**

```bash
git branch
```

**输出：**

```
  feature/about-page
* main
```

你会发现，新分支已经被创建了，但我们**仍然停留在 `main` 分支上**（`*` 还在 `main` 前面）。

#### 第 3 步：切换到新分支 (`git checkout` / `git switch`)

为了在新分支上进行开发，我们需要切换过去。这里有两个命令可以使用，效果一样，但 `git switch` 是新版本 Git 推荐的，因为它更专注、不易误用。

**方法一 (现代推荐): `git switch <branch-name>`**

```bash
git switch feature/about-page
```

**输出：**

```
Switched to branch 'feature/about-page'
```

**方法二 (传统通用): `git checkout <branch-name>`**

```bash
git checkout feature/about-page
```

**输出：**

```
Switched to branch 'feature/about-page'
```

> **区别小贴士**：`git checkout` 是一个功能非常多的命令，除了切换分支，还能恢复文件，所以有时候会让人困惑。`git switch` 命令则专门用于切换分支，意图更清晰。建议你开始习惯使用 `git switch`。

现在，我们再来查看一下分支状态：

```bash
git branch
```

**输出：**

```
* feature/about-page
  main
```

星号 `*` 已经移动到了 `feature/about-page` 前面，表示我们已经成功切换！现在，我们所有的修改都将在这个新分支上进行，不会影响到 `main` 分支。

#### 第 4 步：在新分支上开发

现在我们可以安全地开始工作了。

```bash
# 1. 创建 "关于我" 页面
echo "关于我：我是一名软件工程师。" > about.html

# 2. 修改主页，添加一个指向 "关于我" 页面的链接
echo '<a href="./about.html">关于我</a>' >> index.html

# 3. 提交我们的工作成果
git add .
git commit -m "Feat: Add about page and link from homepage"
```

现在，`feature/about-page` 分支就比 `main` 分支领先了一个 commit。你可以通过 `git log` 查看提交历史来验证这一点。

#### 第 5 步：合并分支 (`git merge <branch-name>`)

“关于我”页面已经开发完成并通过了测试。现在是时候将这些新代码合并回 `main` 分支，让它正式成为网站的一部分了。

**合并分为两步，这非常重要：**

1.  **首先，切换回你想要接收代码的目标分支。** 在我们的例子中，是 `main` 分支。

    ```bash
    git switch main
    ```

    **输出：**

    ```
    Switched to branch 'main'
    ```

    这时如果你查看文件夹，会发现 `about.html` 文件消失了，`index.html` 也变回了原来的样子。别担心，这是正常的，因为 `main` 分支上还没有这些改动。

2.  **然后，执行 `git merge` 命令，告诉 Git 把哪个分支的改动合并过来。**

    ```bash
    git merge feature/about-page
    ```

    **输出：**

    ```
    Updating a1b2c3d..e4f5g6h
    Fast-forward
     about.html | 1 +
     index.html | 1 +
     2 files changed, 2 insertions(+)
     create mode 100644 about.html
    ```

    这个输出告诉我们，Git 进行了“Fast-forward”（快进）合并，这是最简单的合并方式，因为 `main` 分支在我们开发期间没有任何新的提交。现在 `main` 分支已经包含了所有 `feature/about-page` 的新代码了。

    再次查看文件夹，你会发现 `about.html` 出现了，`index.html` 也更新了！

#### 第 6 步：删除已合并的分支 (`git branch -d <branch-name>`)

`feature/about-page` 分支的历史使命已经完成，它的所有代码都已经被合并到 `main` 分支了。为了保持仓库的整洁，我们应该删除它。

```bash
git branch -d feature/about-page
```

**输出：**

```
Deleted branch feature/about-page (was e4f5g6h).
```

  * `-d` 是 `--delete` 的缩写，它是一个“安全”的删除命令。
  * **如果** `feature/about-page` 分支上还有一些工作没有被合并到当前分支，Git 会阻止你删除它，并给出提示。这可以防止你意外丢失代码。

#### 第 7 步：强制删除分支 (`git branch -D <branch-name>`)

现在，我们来模拟一个不同的场景。假设我们又创建了一个分支，准备开发“联系我们”页面。

```bash
git branch feature/contact
git switch feature/contact
echo "联系方式：xxx" > contact.html
git add .
git commit -m "WIP: Start contact page" # WIP = Work in Progress
```

我们在这个分支上做了一些工作，但突然产品经理说：“这个功能我们不要了！”。

这个 `feature/contact` 分支还没有合并到 `main`，而且我们也不打算合并它了。如果我们尝试用 `-d` 来删除：

```bash
git switch main
git branch -d feature/contact
```

**Git 会报错：**

```
error: The branch 'feature/contact' is not fully merged.
If you are sure you want to delete it, run 'git branch -D feature/contact'.
```

Git 提醒我们，这个分支还有未合并的代码，怕我们误删。

既然我们确定要放弃这些代码，就要用到强制删除命令 `-D`。

```bash
git branch -D feature/contact
```

**输出：**

```
Deleted branch feature/contact (was f8g9h0i).
```

  * `-D` (大写的D) 是 `--delete --force` 的缩写。它会**无视**分支是否已经合并，直接、强制地删除该分支。
  * **这是一个危险的命令**，因为你会永久性地丢失在这个分支上所做的所有未合并的 commit。使用前请务必三思。

-----

### 总结

| 命令 | 完整写法 | 作用 | 使用场景 |
| :--- | :--- | :--- | :--- |
| `git branch` | `git branch` | **列出**所有本地分支，并用 `*` 标记当前所在分支。 | 开始工作前，查看当前状态。 |
| `git branch <name>` | `git branch <branch-name>` | **创建**一个新分支，但**不**切换过去。 | 准备开始一个新任务时。 |
| `git checkout <name>` | `git checkout <branch-name>` | **切换**到指定分支（功能较多，旧用法）。 | 切换到分支进行开发或查看。 |
| `git switch <name>` | `git switch <branch-name>` | **切换**到指定分支（功能专一，新用法）。 | 推荐使用此命令切换分支。 |
| `git merge <name>` | `git merge <branch-name>` | 将指定分支的改动**合并**到**当前**分支。 | 功能开发完成后，合入主干。 |
| `git branch -d <name>` | `git branch --delete <branch-name>` | **安全地删除**一个**已经合并**的分支。 | 合并完成后，清理仓库。 |
| `git branch -D <name>` | `git branch --delete --force <branch-name>` | **强制删除**一个分支，无论它是否已合并。 | 确定要放弃某个分支上的所有工作时。 |

希望这个从零开始的案例能帮助你彻底理解这些核心的 Git 分支命令！多动手练习是掌握它们的最好方法。