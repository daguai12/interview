å¥½é—®é¢˜ ğŸ‘ã€‚
C++11 å°±å¼•å…¥äº† lambda è¡¨è¾¾å¼ï¼ˆé—­åŒ…ï¼‰ï¼ŒC++14 åœ¨æ­¤åŸºç¡€ä¸Šåšäº†å¾ˆå…³é”®çš„å¢å¼ºï¼Œä½¿å¾— lambda æ›´åŠ çµæ´»å’Œå®ç”¨ã€‚ä¸‹é¢æˆ‘ç»™ä½ æ•´ç†ä¸€ä¸‹ **C++14 æ–°å¢çš„ lambda ç‰¹æ€§**ï¼š

---

## 1. **æ³›å‹ lambda (Generic lambda)**

### C++11ï¼š

```cpp
auto f = [](int a, int b) { return a + b; };
```

å‚æ•°ç±»å‹å¿…é¡»å†™æ­»ï¼Œæƒ³æ”¯æŒå¤šä¸ªç±»å‹ï¼Œå°±å¾—ç”¨æ¨¡æ¿å‡½æ•°ã€‚

### C++14ï¼š

å‚æ•°å¯ä»¥ç”¨ **`auto`**ï¼Œlambda ä¼šè¢«ç¼–è¯‘å™¨ç¿»è¯‘æˆæ¨¡æ¿åŒ–çš„ `operator()`ï¼š

```cpp
auto f = [](auto a, auto b) { return a + b; };

std::cout << f(1, 2) << "\n";     // int
std::cout << f(1.5, 2.3) << "\n"; // double
std::cout << f(std::string("hi "), "there") << "\n"; // string + const char*
```

ğŸ“Œ åŸç†ï¼šç¼–è¯‘å™¨ç”Ÿæˆçš„é—­åŒ…ç±» `operator()` æ˜¯ä¸ªæ¨¡æ¿ï¼š

```cpp
struct __Lambda {
    template<typename T1, typename T2>
    auto operator()(T1 a, T2 b) const { return a + b; }
};
```

---

## 2. **æ•è·åˆå§‹åŒ– (Lambda capture initializers / generalized capture)**

C++14 å…è®¸åœ¨æ•è·åˆ—è¡¨é‡Œç›´æ¥å†™åˆå§‹åŒ–è¡¨è¾¾å¼ï¼Œç›¸å½“äºâ€œåœ¨æ•è·æ—¶å®šä¹‰æ–°å˜é‡â€ã€‚

### ä¾‹å­ï¼š

```cpp
int x = 10;

// æ•è·æ—¶åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„å˜é‡ y
auto f = [y = x + 1]() {
    return y;
};

std::cout << f() << "\n"; // è¾“å‡º 11
```

### æ›´å¼ºå¤§çš„ç”¨æ³•ï¼šç§»åŠ¨æ•è·

åœ¨ C++11 ä¸­ï¼Œlambda åªèƒ½æ•è·æ‹·è´æˆ–å¼•ç”¨ï¼Œæ²¡æ³•æ•è·ä¸€ä¸ªåªèƒ½ç§»åŠ¨çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ `std::unique_ptr`ï¼‰ã€‚

C++14 è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š

```cpp
#include <memory>
#include <iostream>

int main() {
    auto ptr = std::make_unique<int>(42);

    // é€šè¿‡æ•è·åˆå§‹åŒ– + std::moveï¼ŒæŠŠ unique_ptr ç§»åŠ¨è¿› lambda
    auto f = [p = std::move(ptr)]() {
        return *p;
    };

    std::cout << f() << "\n"; // 42
}
```

è¿™é‡Œ `p` æˆä¸º lambda å†…éƒ¨çš„æˆå‘˜å˜é‡ï¼ˆunique\_ptrï¼‰ï¼ŒåŸå§‹çš„ `ptr` å·²ç»ä¸ºç©ºã€‚

---

## 3. **è¿”å›ç±»å‹æ¨å¯¼**

### C++11ï¼š

å¦‚æœ lambda çš„è¿”å›ç±»å‹å¤æ‚ï¼Œæˆ–è€…æ¶‰åŠåˆ° `auto` æ¨å¯¼ï¼Œéœ€è¦æ‰‹åŠ¨å†™ï¼š

```cpp
auto f = [](int a, int b) -> double { return a + b + 0.5; };
```

### C++14ï¼š

å’Œæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œlambda çš„è¿”å›ç±»å‹å¯ä»¥è‡ªåŠ¨æ¨å¯¼ï¼ˆåªè¦æ‰€æœ‰ `return` è¯­å¥è¿”å›ç±»å‹ä¸€è‡´ï¼‰ï¼š

```cpp
auto f = [](int a, int b) { return a + b + 0.5; }; // è‡ªåŠ¨æ¨å¯¼ä¸º double
```

---

## 4. **æ€»ç»“è¡¨**

| ç‰¹æ€§        | C++11               | C++14                       |
| --------- | ------------------- | --------------------------- |
| å‚æ•° `auto` | âŒ ä¸æ”¯æŒ               | âœ… æ³›å‹ lambda                 |
| æ•è·æ—¶åˆå§‹åŒ–    | âŒ åªèƒ½ `[x]` / `[&x]` | âœ… `[y = expr]`              |
| ç§»åŠ¨æ•è·      | âŒ ä¸èƒ½æ•è· `unique_ptr` | âœ… æ”¯æŒ `[p = std::move(obj)]` |
| è¿”å›ç±»å‹      | âŒ å¿…é¡»æ˜¾å¼å†™ï¼ˆé™¤éå¾ˆç®€å•ï¼‰      | âœ… è‡ªåŠ¨æ¨å¯¼                      |

---

## 5. å°ç»“

C++14 çš„ lambda ç‰¹æ€§é‡ç‚¹æœ‰ä¸‰ç‚¹ï¼š

1. **æ³›å‹ lambda** â†’ å‚æ•°èƒ½å†™ `auto`ï¼Œç›¸å½“äºæ¨¡æ¿åŒ– `operator()`ã€‚
2. **æ•è·åˆå§‹åŒ–** â†’ æ•è·æ—¶å¯ä»¥å†™åˆå§‹åŒ–è¡¨è¾¾å¼ï¼Œæ”¯æŒç§»åŠ¨æ•è·ã€‚
3. **è¿”å›ç±»å‹è‡ªåŠ¨æ¨å¯¼** â†’ ä¸ç”¨å†å†™å†—ä½™çš„ `-> decltype(...)`ã€‚

---

è¦ä¸è¦æˆ‘å¸®ä½ å†™ä¸€æ®µ **ç»¼åˆä¾‹å­**ï¼ŒæŠŠ C++14 lambda çš„ä¸‰å¤§æ–°ç‰¹æ€§ï¼ˆæ³›å‹ã€ç§»åŠ¨æ•è·ã€è¿”å›ç±»å‹æ¨å¯¼ï¼‰ç»“åˆèµ·æ¥æ¼”ç¤ºï¼Ÿ
