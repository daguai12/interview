好 👍
我就把 **C++ 后端开发最常用的 Bash 功能**给你整理成一个**速查表**，专门突出你实际会用到的地方。

---

# 🧩 C++ 后端程序员必学的 Bash 功能速查表

## 1. 变量与参数扩展（脚本必备）

| 功能        | 写法                    | 示例                   | 作用                         |
| --------- | --------------------- | -------------------- | -------------------------- |
| 取值        | `$var` `${var}`       | `echo $USER`         | 获取变量值                      |
| 默认值（不改变量） | `${var:-default}`     | `${PORT:-8080}`      | 如果 var 为空/未定义 → 用 default  |
| 默认并赋值     | `${var:=default}`     | `${LOG_DIR:=/tmp}`   | 如果 var 为空/未定义 → 设为 default |
| 错误退出      | `${var:?msg}`         | `${CONFIG:?missing}` | var 为空/未定义 → 报错并退出         |
| 变量名匹配     | `${!prefix*}`         | `echo ${!LC_*}`      | 列出匹配前缀的变量名                 |
| 字符串长度     | `${#var}`             | `${#PWD}`            | 获取字符串长度                    |
| 子串        | `${var:pos:len}`      | `${str:0:3}`         | 提取子串                       |
| 删除前缀      | `${var#pattern}`      | `${file#*/}`         | 最短匹配删除前缀                   |
| 删除后缀      | `${var%pattern}`      | `${file%.cpp}`       | 最短匹配删除后缀                   |
| 替换        | `${var/pat/repl}`     | `${path//\//-}`      | 替换字符串                      |
| 大小写       | `${var^^}` `${var,,}` | `${name^^}`          | 转大写 / 转小写                  |

👉 常见场景：

* **安全取值**：`${PORT:-8080}` 保证服务有默认端口
* **路径处理**：`${file%.cpp}.o` 自动转目标文件名

---

## 2. 算术扩展（脚本逻辑）

| 功能   | 写法                | 示例                         | 作用              |
| ---- | ----------------- | -------------------------- | --------------- |
| 算术计算 | `$((expr))`       | `echo $((3+5))`            | 返回结果            |
| 条件判断 | `((expr))`        | `((x < 10)) && echo small` | 返回 0/1 用作 if 条件 |
| 自增自减 | `((x++)) ((--y))` |                            | 常见计数器           |
| 进制支持 | `base#num`        | `$((2#1011))` → 11         | 多进制转换           |
| 位运算  | `<< >> & \| ^ ~`  | `$((1<<5))` → 32           | 常见 flags、掩码处理   |
| 条件运算 | `?:`              | `$((x>y?x:y))`             | 取最大值            |

👉 常见场景：

* **循环计数器**：`for ((i=0;i<10;i++)) ...`
* **位掩码操作**：检查/设置权限标志

---

## 3. `bc` 任意精度计算（浮点必备）

| 功能          | 示例                           | 作用                         |
| ----------- | ---------------------------- | -------------------------- |
| 交互模式        | `bc -l`                      | 启动 bc 计算器                  |
| 管道计算        | `echo "3.5/7" \| bc -l`      | 一次性计算                      |
| 控制小数位       | `echo "scale=3; 10/3" \| bc` | 结果：3.333                   |
| here string | `bc -l <<< "s(1.57)"`        | 直接计算表达式                    |
| 数学库         | `bc -l`                      | 提供 `s(x)`、`c(x)`、`sqrt(x)` |

👉 常见场景：

* **性能测试脚本**：计算平均耗时、TPS
* **运维脚本**：磁盘/内存利用率计算

---

## 4. 综合应用（后端常用写法）

✅ **保证服务端口有默认值**

```bash
PORT=${PORT:-8080}
echo "Listening on $PORT"
```

✅ **批量编译 C++ 文件**

```bash
for f in *.cpp; do
    g++ "$f" -o "${f%.cpp}"
done
```

✅ **性能对比脚本**

```bash
time ./server &
pid=$!
sleep 10
kill $pid
```

✅ **算术扩展控制循环**

```bash
for ((i=1;i<=5;i++)); do
    echo "Run $i"
done
```

✅ **计算平均响应时间**

```bash
avg=$(echo "scale=2; $total/$count" | bc)
echo "Average: $avg ms"
```

---

📌 **总结**
对 C++ 后端来说：

* **必须熟练**：变量扩展（默认值/路径处理）、算术扩展（计数/位运算）、bc 浮点计算。
* **次要但有用**：大小写转换、变量名匹配、复杂字符串替换。
* **高阶用法**：脚本性能调优时避免外部命令，用参数扩展替代 `sed`/`awk`。

---

要不要我帮你再写一个 **“C++ 后端日常脚本示例合集”**（比如日志分析、内存检查、端口检测、批量启动服务）？这样就不只是速查，而是直接能拿去用的脚本。
