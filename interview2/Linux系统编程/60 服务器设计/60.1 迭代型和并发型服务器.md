### **60.1 迭代型和并发型服务器**

对于使用 Socket（套接字）的网络服务器端程序，有两种常见的设计方式。

---
#### **迭代型服务器 (Iterative Server)**

* **工作方式**: 服务器**一次只处理一个客户端**。它 `accept()` 一个连接，然后为这个客户端提供完整的服务（接收请求、处理、发送响应），直到与该客户端的交互结束后，才会再次 `accept()` 下一个客户端的连接。
* **适用场景**: 通常只适用于那些能够**快速处理**客户端请求的场景。例如，客户端和服务器之间只交换单个、简单的请求和响应。
* **缺点**: 如果一个客户端的请求需要很长的处理时间，那么所有其他正在等待的客户端都将被**阻塞**。

---
#### **并发型服务器 (Concurrent Server)**

* **工作方式**: 这种类型的服务器被设计为能够**同时处理多个客户端**的请求。
* **适用场景**: 适用于对每个请求都需要大量处理时间，或者是当客户端和服务器在进行扩展对话中需要来回传递消息的场景。
* **传统实现模型 (每连接一个进程)**:
    * **主进程 (父进程)**: 其主要任务是在一个循环中调用 `accept()` 来等待并接受新的客户端连接。
    * **子进程**: 每当 `accept()` 成功返回一个新连接时，主进程就 `fork()` 一个**新的子进程**来专门处理这个客户端。每个子进程在完成对单个客户端的服务后就终止。
    * 由于这些子进程能独立地并行运行，因此服务器可以同时为多个客户端提供服务。

> **变种**: 另一种常见的并发模型是为每个客户端创建一个新的**线程**，而不是进程。

在接下来的几节中，我们将学习迭代型和并发型服务器程序的例子，它们都将实现 **echo 服务**（RFC 862），这种基本的服务会原样返回客户端向其发送的任何内容。