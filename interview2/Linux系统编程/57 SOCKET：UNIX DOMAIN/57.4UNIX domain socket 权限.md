### **57.4 UNIX domain socket 权限**

socket 文件的所有权和文件系统权限，决定了哪些进程能够与这个 socket 进行通信。

#### **所需权限**
* 要 `connect()` 一个 UNIX domain **流 socket**，需要对该 socket 文件拥有**写权限 (`w`)**。
* 要通过一个 UNIX domain **数据报 socket** 发送一个数据报，需要在该 socket 文件上拥有**写权限 (`w`)**。

此外，在以上两种情况下，都需要对存放 socket 路径名的所有**目录**拥有**执行（搜索）权限 (`x`)**。

#### **设置权限**
* **默认权限**: 当通过 `bind()` 创建 socket 文件时，默认会给所有者（user）、组（group）以及其他用户（other）赋予所有权限 (`rwxrwxrwx`)。
* **修改行为**: 要创建权限更严格的 socket 文件，可以在调用 `bind()` **之前**，先调用 `umask()` 来屏蔽掉不希望赋予的权限。

#### **可移植性警告**
一些系统会**忽略 socket 文件本身**的权限（SUSv3 允许这种行为）。

这意味着，完全依赖 socket 文件自身的 `rwx` 权限来控制对 socket 的访问，这种做法是**不可移植的**。

**可移植的替代方案**:
更可靠、更具可移植性的访问控制方法是，将 socket 文件创建在一个**受保护的目录**中，并通过控制**宿主目录**的权限来间接控制对 socket 的访问。