### **14.2 磁盘和分区**

常规文件和目录通常都存放在硬盘设备里。下面几节将介绍磁盘的组织方式，以及如何对其分区。

#### **磁盘驱动器**

硬盘驱动器是一种机械装置，由一个或多个高速旋转的盘片组成。通过在磁盘上快速移动的读/写磁头，便可获取或修改磁盘表面的磁性编码信息。

  * **物理结构**: 磁盘表面信息物理上存储于称为**磁道 (track)** 的一组同心圆上。磁道自身又被划分为若干**扇区 (sector)**，每个扇区则包含一系列**物理块 (physical block)**。
  * **最小读写单元**: 物理块的容量一般为 512 字节（或其倍数），代表了驱动器可读/写的最小信息单元。
  * **访问耗时**: 读写磁盘信息耗时相对较长，主要由三部分组成：
    1.  **寻道时间 (Seek time)**: 磁头移动到相应磁道所需的时间。
    2.  **旋转延迟 (Rotational latency)**: 等待相应扇区旋转到磁头下方所需的时间。
    3.  **传输时间 (Transfer time)**: 实际从块上传输数据所需的时间。

执行上述操作所耗费的时间总量通常以毫秒为单位，相比之下，现代 CPU 在同样的时间内可执行数百万条指令。

#### **磁盘分区**

可将每块磁盘划分为一个或多个不重叠的**分区 (partition)**。内核则将每个分区视为位于 `/dev` 路径下的一个单独设备（例如 `/dev/sda1`, `/dev/sda2`）。

  * **管理工具**: 系统管理员可使用 `fdisk` 命令来决定磁盘分区的编号、大小和类型。`fdisk –l` 命令会列出磁盘上的所有分区。
  * **内核信息**: Linux 专有文件 `/proc/partitions` 记录了系统中每个磁盘分区的主辅设备编号、大小（以千字节为单位）和名称。
    ```bash
    $ cat /proc/partitions
    major minor  #blocks  name

       8        0  488386584 sda
       8        1    1048576 sda1
       8        2  487336960 sda2
    ```

磁盘分区可容纳任何类型的信息，但通常只会包含以下三种之一：

1.  **文件系统 (A filesystem)**: 用来存放常规文件和目录。
2.  **数据区域 (A data area)**: 可作为裸设备对其进行直接 I/O 访问（一些数据库管理系统会使用该技术）。
3.  **交换区域 (A swap area)**: 供内核的内存管理之用。
      * **创建**: 可通过 `mkswap(8)` 命令来创建交换区域。
      * **启用/停用**: 特权进程可利用 `swapon()` 和 `swapoff()` 系统调用来启用或停用一个交换分区。
      * **查看**: 可使用 Linux 专有文件 `/proc/swaps` 来查看系统中当前已激活的交换区域的信息。