### **14.7 单根目录层级和挂载点**

与其他 UNIX 系统一样，Linux 上所有文件系统中的文件都位于一个**单根目录树**下，树根就是根目录 **`/`**。其他的文件系统都被**挂载 (mount)** 在根目录之下，被视为整个目录层级的子树 (subtree)。

超级用户可使用如下命令来挂载文件系统：

```bash
# mount device directory
```

这条命令会将名为 `device` 的设备（通常是一个磁盘分区，如 `/dev/sda2`）上的文件系统，挂接到目录层级中由 `directory` 所指定的目录。这个 `directory` 就是该文件系统的**挂载点 (mount point)**。可使用 `umount` 命令卸载文件系统。

> **挂载命名空间 (Mount Namespaces)**:
> 自 Linux 2.4.19 以后，内核支持针对每个进程的挂载命名空间。这意味着每个进程都可能拥有属于自己的一组私有的文件系统挂载点，因此不同进程视角下的目录层级可能会有所不同。

不带任何参数来执行 `mount` 命令，可以列出当前已挂载的文件系统，如下例所示（内容有删减）：

```
$ mount
/dev/sda2 on / type ext3 (rw)
proc on /proc type proc (rw)
sysfs on /sys type sysfs (rw)
/dev/sda1 on /boot type ext2 (rw)
/dev/sda3 on /home type ext3 (rw)
usbfs on /proc/bus/usb type usbfs (rw)
```

[[mount内容解释]]
#### **挂载点如何工作**

下图演示了如何将上述 `mount` 命令输出中的挂载点映射到目录层级中。

**概念示意图:**

```
/ (根目录, 来自 /dev/sda2)
|
├── bin/
├── etc/
├── lib/
├── proc/  (这是一个挂载点, 其内容由 proc 文件系统提供)
├── sys/   (这是一个挂载点, 其内容由 sysfs 文件系统提供)
├── boot/  (这是一个挂载点, 其内容来自 /dev/sda1)
|   └── vmlinuz
|
└── home/  (这是一个挂载点, 其内容来自 /dev/sda3)
    ├── user1/
    |   └── a.txt
    └── user2/
```

**解读:**

  * 整个目录树的起点是根目录 `/`。根目录自身的内容来自 `/dev/sda2` 这个设备上的文件系统。
  * 当你访问 `/` 目录时，你会看到像 `bin`、`etc`、`boot`、`home` 这样的子目录。
  * 其中，`bin` 和 `etc` 是根文件系统（`/dev/sda2`）上真实存在的目录。
  * 然而，`boot` 和 `home` 是**挂载点**。
      * 当你访问 `/boot` 目录及其中的文件（如 `/boot/vmlinuz`）时，你实际上访问的是挂载在 `/boot` 上的另一个设备——`/dev/sda1`——上的文件系统内容。
      * 同理，当你访问 `/home/user1/a.txt` 时，你访问的是 `/dev/sda3` 设备上的文件系统。

通过这种方式，Linux 将多个物理设备或虚拟设备上的文件系统无缝地组织成一个单一、连续的目录树。用户在浏览文件时，通常不需要关心一个文件具体存放在哪个物理设备上。

![[Pasted image 20250910100827.png]]
![[Pasted image 20250910100750.png]]

