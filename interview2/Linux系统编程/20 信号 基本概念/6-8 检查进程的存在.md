### 第一部分总结：20.6 检查进程的存在性

本节主要介绍如何判断一个具有特定 PID 的进程是否存在。

1.  **核心方法：使用 `kill()` 发送空信号**
    * 调用 `kill(pid, 0)` 可以实现这个功能。信号编号为 `0` 是一个特殊的“**空信号**”，它不会真的发送任何信号。
    * `kill()` 调用会执行其常规的错误检查，我们可以根据其结果来判断进程状态：
        * **调用成功 (返回 0)**：表示进程存在，并且当前用户**有权限**给它发信号。
        * **调用失败且 `errno` 为 `EPERM`**：表示进程存在，但当前用户**没有权限**给它发信号。
        * **调用失败且 `errno` 为 `ESRCH`**：表示**不存在**该 PID 的进程。
    * **结论**：只要 `kill(pid, 0)` 的结果不是失败且 `errno` 不为 `ESRCH`，就说明该进程存在。

2.  **此方法的局限性**
    * **PID 复用**：即使 PID 存在，也不能保证它还是你最初关注的那个程序，因为内核会回收并重新分配 PID。
    * **僵尸进程**：存在的 PID 可能属于一个“僵尸进程”（已终止但其父进程尚未回收其资源的进程）。

3.  **其他检查进程存在的方法**
    * `wait()` 系统调用：仅用于监控自己的子进程。
    * **锁机制**（信号量、文件锁）：如果目标进程一直持有一个锁，当监控进程能获取到该锁时，说明目标进程已终止。
    * **IPC 通道**（管道、FIFO）：让目标进程持有一个管道的写端，监控进程持有读端。当目标进程终止时，写端关闭，监控进程会从读端读到“文件结束符 (EOF)”。
    * **/proc/PID 接口**：检查 `/proc/PID` 目录是否存在。如果目录存在（例如 `/proc/12345`），说明 PID 为 12345 的进程就存在。

---

### 第二部分总结：20.7 发送信号的其他方式

本节介绍了 `raise()` 和 `killpg()` 两个函数。

1.  **`raise(int sig)`：向自身发送信号**
    * **作用**：让进程（或线程）给自己发送一个信号。
    * **与 `kill()` 的关系**：
        * 在**单线程**程序中，`raise(sig)` 等价于 `kill(getpid(), sig)`。
        * 在**多线程**程序中，`raise(sig)` 等价于 `pthread_kill(pthread_self(), sig)`，它会将信号发送给**调用 `raise()` 的那个特定线程**。而 `kill(getpid(), sig)` 会将信号发给整个进程，由进程中的任意一个线程来处理。
    * **存在意义**：`raise()` 是 C89 标准的一部分，因为它不依赖于“进程ID”这种操作系统特有的概念，所以具有更好的跨平台性。

2.  **`killpg(int pgrp, int sig)`：向进程组发送信号**
    * **作用**：向一个指定进程组的所有成员发送信号。
    * **与 `kill()` 的关系**：`killpg(pgrp, sig)` 等价于 `kill(-pgrp, sig)`。
    * **特殊用法**：如果 `pgrp` 为 0，则向调用者所在的进程组发送信号。

---

### 第三部分总结：20.8 显示信号描述

本节介绍了如何获取信号的人类可读的描述字符串。

1.  **`strsignal(int sig)`：将信号编号转为描述字符串**
    * **作用**：输入一个信号编号（如 `SIGPIPE`），返回一个指向对应描述字符串（如 "Broken pipe"）的指针。
    * **优点**：比直接访问 `sys_siglist` 数组更安全（因为它会做边界检查），并且支持**本地化**（可以根据系统语言环境返回不同语言的描述）。

2.  **`psignal(int sig, const char *msg)`：打印信号描述到标准错误**
    * **作用**：向标准错误（stderr）输出一个格式化的字符串。
    * **输出格式**：`用户自定义消息: 信号的描述`。
    * **示例**：`psignal(SIGPIPE, "Error occurred")` 可能会打印出 `Error occurred: Broken pipe`。
    * **优点**：非常方便地将自定义错误信息和系统提供的标准信号描述结合起来输出。同样支持本地化。