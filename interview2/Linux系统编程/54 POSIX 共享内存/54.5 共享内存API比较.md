好的，这是根据您提供的文本内容，保留原始结构和标题整理的结果。

### **54.5 共享内存 API 比较**

本节将对几种不同的、用于在无关进程间共享内存区域的技术进行比较：
* **System V 共享内存** (第 48 章)
* **共享文件映射** (49.4.2 节)
* **POSIX 共享内存** (本章主题)

#### **共同特性**
所有这些共享内存技术都具备以下共同点：
* 它们都提供了**快速的 IPC (进程间通信)**，但应用程序通常必须使用一个**信号量**或其他同步原语来协调对共享区域的访问。
* 一旦共享内存区域被映射进进程的虚拟地址空间，它就与进程内存空间中的其他部分无异了。
* 系统会将共享内存区域放置进进程的虚拟地址空间中。在 Linux 上，可以通过 `/proc/PID/maps` 文件查看所有种类的共享内存区域信息。
* 因为共享区域在不同进程中的虚拟地址可能不同，所以对区域中位置的引用应使用**偏移量**而不是绝对指针。
* 在第 50 章介绍的操作虚拟内存区域的函数（如 `mlock()`）可被应用于所有这些共享内存区域。

---
#### **显著差异**

在这些共享内存技术之间也存在一些显著的差异，下表对此进行了总结：

| 特性 | System V 共享内存 | 共享文件映射 | POSIX 共享内存 |
| :--- | :--- | :--- | :--- |
| **持久性** | **否** (内核持久性，重启后丢失) | **是** (内容与磁盘文件同步) | **否** (内核持久性，重启后丢失) |
| **标识方式** | **键 (Key) / 标识符 (Identifier)** | **文件名 / 文件描述符** | **名称 (`/name`) / 文件描述符** |
| **API 模型**| 专用的、非标准 I/O 模型 (`shmget`, `shmctl`) | 与标准 UNIX 文件 I/O 模型一致 | 与标准 UNIX 文件 I/O 模型一致 |
| **调整大小**| **不支持** (创建时大小固定) | **支持** (通过 `ftruncate` 调整) | **支持** (通过 `ftruncate` 调整) |
| **历史可移植性**| **最佳** (几乎所有 UNIX 都支持) | 良好 | 较差 (但现代 UNIX 已普遍支持) |

---
#### **结论与建议**
除了在非常古老的系统上的可移植性之外，**共享文件映射**和 **POSIX 共享内存**在几乎所有方面都优于 System V 共享内存。

因此，在新的应用程序中，应该优先从这两个接口中挑选一个使用，而不是 System V 共享内存。

**至于选择哪个接口，则取决于是否需要持久性存储：**
* 如果你需要共享的数据能够在系统重启之间**得到持久保存**，那么应该使用**共享文件映射**。
* 如果你**无需持久存储**，那么应该使用 **POSIX 共享内存**，以避免使用磁盘文件所产生的额外开销。