# `bind()`
### ğŸ”§ å‡½æ•°å£°æ˜

```cpp
bool TcpServer::bind(const std::vector<Address::ptr>& addrs,
                     std::vector<Address::ptr>& fails,
                     bool ssl)
```

#### âœ… å‚æ•°å«ä¹‰ï¼š

* `addrs`ï¼šä¼ å…¥çš„å¤šä¸ªç›‘å¬åœ°å€ï¼ˆå¯èƒ½ç›‘å¬å¤šä¸ªç«¯å£/IPï¼‰ï¼Œæ˜¯ `Address` ç±»çš„æ™ºèƒ½æŒ‡é’ˆã€‚
* `fails`ï¼šå¼•ç”¨ä¼ å‡ºå‚æ•°ï¼Œç”¨äºæ”¶é›†ç»‘å®šå¤±è´¥çš„åœ°å€ã€‚
* `ssl`ï¼šæ˜¯å¦ä½¿ç”¨ SSLï¼Œå³æ˜¯å¦åˆ›å»ºåŠ å¯†è¿æ¥ã€‚

#### âœ… è¿”å›å€¼ï¼š

* `true` è¡¨ç¤ºæ‰€æœ‰åœ°å€ç»‘å®šå¹¶ç›‘å¬æˆåŠŸï¼›
* `false` è¡¨ç¤ºè‡³å°‘æœ‰ä¸€ä¸ªåœ°å€ç»‘å®šæˆ–ç›‘å¬å¤±è´¥ã€‚

---

## ğŸ” å‡½æ•°å®ç°åˆ†æ

---

### Step 1ï¼šä¿å­˜ `ssl` æ ‡å¿—ä½

```cpp
m_ssl = ssl;
```

* å°†ä¼ å…¥çš„ `ssl` å‚æ•°ä¿å­˜ä¸ºæˆå‘˜å˜é‡ `m_ssl`ï¼Œä¾›åç»­ä½¿ç”¨ï¼ˆä¾‹å¦‚åˆ›å»º Socketã€æ‰“å°æ—¥å¿—ã€æ¡ä»¶åˆ†æ”¯ç­‰ï¼‰ã€‚

---

### Step 2ï¼šéå†æ¯ä¸ªåœ°å€å¹¶å°è¯•ç»‘å®šç›‘å¬

```cpp
for(auto& addr : addrs) {
```

éå†ç”¨æˆ·ä¼ å…¥çš„æ¯ä¸€ä¸ªåœ°å€ `addr`ï¼Œå°è¯•æ‰§è¡Œç»‘å®šç›‘å¬æµç¨‹ã€‚

---

#### Step 2.1ï¼šæ ¹æ®æ˜¯å¦ä½¿ç”¨ SSL åˆ›å»º TCP Socket

```cpp
Socket::ptr sock = ssl ? SSLSocket::CreateTCP(addr) : Socket::CreateTCP(addr);
```

* å¦‚æœå¯ç”¨äº† `ssl`ï¼Œè°ƒç”¨ `SSLSocket::CreateTCP()` åˆ›å»ºä¸€ä¸ªæ”¯æŒ SSL çš„ TCP Socketï¼›
* å¦åˆ™è°ƒç”¨æ™®é€šçš„ `Socket::CreateTCP()`ã€‚
* åˆ›å»ºçš„ socket å¯¹è±¡æ˜¯æ™ºèƒ½æŒ‡é’ˆ `Socket::ptr` ç±»å‹ï¼ˆåŒ…å« RAII è‡ªåŠ¨ç®¡ç†èµ„æºé”€æ¯ï¼‰ã€‚

---

#### Step 2.2ï¼šå°è¯•ç»‘å®šè¯¥åœ°å€

```cpp
if(!sock->bind(addr)) {
```

* ä½¿ç”¨è¯¥ socket ç»‘å®šåœ°å€ï¼ˆå³è°ƒç”¨ç³»ç»Ÿ `bind` å‡½æ•°ï¼‰ã€‚
* å¦‚æœç»‘å®šå¤±è´¥ï¼š

```cpp
SYLAR_LOG_ERROR(g_logger) << "bind fail errno="
    << errno << " errstr=" << strerror(errno)
    << " addr=[" << addr->toString() << "]";
fails.push_back(addr);
continue;
```

* æ‰“æ—¥å¿—ï¼ˆåŒ…æ‹¬å¤±è´¥åŸå› å’Œåœ°å€ï¼‰ï¼›
* æŠŠå¤±è´¥åœ°å€åŠ å…¥ `fails` åˆ—è¡¨ï¼›
* è·³è¿‡å½“å‰ socketï¼Œä¸å†å°è¯• listenï¼Œç»§ç»­ä¸‹ä¸€åœ°å€ã€‚

---

#### Step 2.3ï¼šå¦‚æœç»‘å®šæˆåŠŸï¼Œå°è¯•ç›‘å¬

```cpp
if(!sock->listen()) {
```

* è°ƒç”¨ç³»ç»Ÿ `listen` å‡½æ•°è®© socket å¼€å§‹ç›‘å¬å®¢æˆ·ç«¯è¿æ¥ã€‚
* å¦‚æœå¤±è´¥ï¼š

```cpp
SYLAR_LOG_ERROR(g_logger) << "listen fail errno="
    << errno << " errstr=" << strerror(errno)
    << " addr=[" << addr->toString() << "]";
fails.push_back(addr);
continue;
```

* åŒæ ·è®°å½•æ—¥å¿—ï¼›
* æŠŠå¤±è´¥åœ°å€åŠ å…¥ `fails`ï¼›
* è·³è¿‡æ­¤ socketã€‚

---

#### Step 2.4ï¼šæˆåŠŸç»‘å®šå¹¶ç›‘å¬ï¼Œå°† socket åŠ å…¥ `m_socks`

```cpp
m_socks.push_back(sock);
```

* å°†æˆåŠŸç»‘å®šç›‘å¬çš„ socket å­˜å…¥æˆå‘˜å˜é‡ `m_socks`ï¼ˆç”¨äºåç»­æ¥æ”¶è¿æ¥ï¼‰ã€‚

---

### Step 3ï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨å¤±è´¥ç»‘å®š

```cpp
if(!fails.empty()) {
    m_socks.clear();
    return false;
}
```

* å¦‚æœ `fails` ä¸ä¸ºç©ºï¼Œè¯´æ˜è‡³å°‘æœ‰ä¸€ä¸ªåœ°å€ç»‘å®šæˆ–ç›‘å¬å¤±è´¥ï¼›
* æ¸…ç©ºå·²æˆåŠŸç»‘å®šçš„ `m_socks`ï¼ˆé˜²æ­¢éƒ¨åˆ†ç»‘å®šæˆåŠŸäº§ç”Ÿæ··ä¹±ï¼‰ï¼›
* è¿”å› `false` è¡¨ç¤ºæ•´ä½“ç»‘å®šå¤±è´¥ã€‚

---

### Step 4ï¼šæ‰“å°æˆåŠŸæ—¥å¿—

```cpp
for(auto& i : m_socks) {
    SYLAR_LOG_INFO(g_logger) << "type=" << m_type
        << " name=" << m_name
        << " ssl=" << m_ssl
        << " server bind success: " << *i;
}
```

* éå†æˆåŠŸç»‘å®šçš„æ‰€æœ‰ socketï¼›
* æ‰“å°æœåŠ¡å™¨ç±»å‹ã€åç§°ã€æ˜¯å¦ä½¿ç”¨ SSLã€ç»‘å®š socket ä¿¡æ¯ï¼ˆé‡è½½äº† `operator<<`ï¼‰ã€‚

---

### Step 5ï¼šè¿”å›æˆåŠŸ

```cpp
return true;
```

* å¦‚æœå…¨éƒ¨åœ°å€éƒ½ç»‘å®šæˆåŠŸï¼Œå‡½æ•°è¿”å› `true`ã€‚

---

## ğŸ“Œ æ€»ç»“è¦ç‚¹

| å…³é”®ç‚¹    | è¯´æ˜                                             |
| ------ | ---------------------------------------------- |
| æ”¯æŒå¤šä¸ªåœ°å€ | å¯ä»¥ç»‘å®šå¤šä¸ªåœ°å€/ç«¯å£ï¼ˆå¦‚ `0.0.0.0:80`, `127.0.0.1:8080`ï¼‰ã€‚ |
| SSL æ”¯æŒ | æ”¯æŒ SSL åŠ å¯†ç›‘å¬ï¼Œé€šè¿‡å‚æ•° `ssl` å†³å®šã€‚                     |
| é”™è¯¯æ”¶é›†   | æ‰€æœ‰ç»‘å®šå¤±è´¥çš„åœ°å€ä¼šè¢«åŠ å…¥ `fails`ï¼Œå¯ä¾›è°ƒç”¨è€…å›æº¯å¤±è´¥åŸå› ã€‚             |
| å®‰å…¨å›æ»š   | ä¸€æ—¦æœ‰å¤±è´¥åœ°å€ï¼Œæ¸…é™¤å…¨éƒ¨æˆåŠŸç»‘å®šï¼Œé˜²æ­¢éƒ¨åˆ†ç»‘å®šå¸¦æ¥çš„å¼‚å¸¸ã€‚                  |
| å¼‚å¸¸æ—¥å¿—   | é”™è¯¯åœºæ™¯ä¸‹ä¼šæ‰“å°è¯¦ç»†æ—¥å¿—ï¼ŒåŒ…æ‹¬ `errno` å’Œåœ°å€å­—ç¬¦ä¸²ï¼Œä¾¿äºå®šä½é—®é¢˜ã€‚         |

# `startAccept()`

å½“ç„¶ï¼Œæˆ‘ä»¬ç»§ç»­ä»¥**é€è¡Œé€å¥ã€è¯¦ç»†åˆ†æ**çš„æ–¹å¼è§£é‡Š `TcpServer::startAccept()` å‡½æ•°çš„å®ç°ã€‚

è¿™ä¸ªå‡½æ•°æ˜¯ Sylar æ¡†æ¶ä¸­ `TcpServer` ç±»çš„æˆå‘˜å‡½æ•°ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯ï¼š

> åœ¨æŸä¸ªå·²ç»ç›‘å¬çš„ socket ä¸Šå¾ªç¯ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ï¼Œå¹¶ä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºæ–°çš„ socketï¼Œå¹¶æŠŠå®¢æˆ·ç«¯è¿æ¥çš„å¤„ç†é€»è¾‘äº¤ç»™ IO åç¨‹è°ƒåº¦å™¨å»æ‰§è¡Œã€‚

---

### å‡½æ•°å®šä¹‰

```cpp
void TcpServer::startAccept(Socket::ptr sock) {
```

* è¿™æ˜¯ä¸€ä¸ª `TcpServer` ç±»çš„æˆå‘˜å‡½æ•°ã€‚
* å‚æ•°æ˜¯ä¸€ä¸ª `Socket::ptr`ï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼‰ï¼Œè¡¨ç¤ºç›‘å¬ socketã€‚
* è¿™ä¸ªå‡½æ•°ä¸ä¼šè¿”å›ï¼Œé™¤éæœåŠ¡å™¨è¢«æ ‡è®°ä¸ºåœæ­¢ï¼ˆ`m_isStop == true`ï¼‰ã€‚

---

### ä¸»ä½“é€»è¾‘ï¼šå¾ªç¯ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥

```cpp
    while(!m_isStop) {
```

* è¿™æ˜¯ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œåªè¦æœåŠ¡å™¨**æœªè¢«åœæ­¢**ï¼ˆ`m_isStop == false`ï¼‰ï¼Œå°±ä¼šä¸æ–­æ‰§è¡Œã€‚
* `m_isStop` æ˜¯ `TcpServer` çš„æˆå‘˜å˜é‡ï¼Œæ ‡å¿—æ˜¯å¦è¦ç»ˆæ­¢æœåŠ¡å™¨ã€‚

---

### æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥

```cpp
        Socket::ptr client = sock->accept();
```

* è°ƒç”¨ç›‘å¬ socket çš„ `accept()` æ–¹æ³•æ¥**æ¥å—ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥**ã€‚
* å¦‚æœæœ‰å®¢æˆ·ç«¯è¿æ¥ä¸Šæ¥ï¼Œè¿™é‡Œå°±ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ socketï¼ˆ`client`ï¼‰ã€‚
* å¦‚æœå¤±è´¥ï¼ˆä¾‹å¦‚ç›‘å¬ socket å…³é—­æˆ–ç³»ç»Ÿå‡ºé”™ï¼‰ï¼Œä¼šè¿”å› `nullptr`ã€‚

---

### åˆ¤æ–­è¿æ¥æ˜¯å¦æˆåŠŸ

```cpp
        if(client) {
```

* å¦‚æœè¿æ¥æˆåŠŸï¼Œå°±è¿›å…¥å¤„ç†åˆ†æ”¯ã€‚
* å¦åˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚

---

### è®¾ç½®å®¢æˆ·ç«¯ socket çš„æ¥æ”¶è¶…æ—¶æ—¶é—´

```cpp
            client->setRecvTimeout(m_recvTimeout);
```

* ä¸ºæ–°è¿æ¥è®¾ç½®æ¥æ”¶è¶…æ—¶æ—¶é—´ã€‚
* `m_recvTimeout` æ˜¯æœåŠ¡å™¨çš„æˆå‘˜å˜é‡ï¼ˆæ•´å‹ï¼Œå•ä½å¯èƒ½æ˜¯æ¯«ç§’ï¼‰ï¼Œç”¨äºæ§åˆ¶ socket åœ¨æ¥æ”¶æ•°æ®æ—¶çš„è¶…æ—¶æ—¶é—´ã€‚
* è¿™æ ·åšæ˜¯ä¸ºäº†é˜²æ­¢å®¢æˆ·ç«¯é•¿æœŸä¸å‘é€æ•°æ®å¯¼è‡´æœåŠ¡ç«¯å¡æ­»ã€‚

---

### è°ƒåº¦å®¢æˆ·ç«¯å¤„ç†é€»è¾‘

```cpp
            m_ioWorker->schedule(std::bind(&TcpServer::handleClient,
                        shared_from_this(), client));
```

* `m_ioWorker` æ˜¯ä¸€ä¸ªåç¨‹è°ƒåº¦å™¨ï¼ˆé€šå¸¸æ˜¯ `IOManager` ç±»å‹ï¼‰ï¼Œè´Ÿè´£å¤„ç† socket çš„è¯»å†™äº‹ä»¶ã€‚
* è¿™é‡Œä½¿ç”¨ `schedule()` å°†å¤„ç†å®¢æˆ·ç«¯çš„é€»è¾‘å‡½æ•°**æ”¾å…¥è°ƒåº¦å™¨ä»»åŠ¡é˜Ÿåˆ—ä¸­**ï¼Œç”±åå° IO åç¨‹çº¿ç¨‹å»å¤„ç†ã€‚

#### è§£é‡Š `std::bind(&TcpServer::handleClient, shared_from_this(), client)`

* `&TcpServer::handleClient`ï¼šæ˜¯ `TcpServer` ç±»çš„æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼Œè¡¨ç¤ºå¤„ç†å®¢æˆ·ç«¯è¿æ¥çš„å‡½æ•°ã€‚
* `shared_from_this()`ï¼š`TcpServer` ç»§æ‰¿äº† `std::enable_shared_from_this`ï¼Œå¯ä»¥å®‰å…¨è·å–è‡ªèº«çš„æ™ºèƒ½æŒ‡é’ˆã€‚
* `client`ï¼šä¼ é€’æ–°è¿æ¥çš„ socket ç»™ `handleClient()`ã€‚
* æ•´ä½“æ„æ€æ˜¯æŠŠ â€œå½“å‰è¿™ä¸ª `TcpServer` å®ä¾‹å»å¤„ç†è¿™ä¸ªå®¢æˆ·ç«¯è¿æ¥â€ å°è£…æˆä»»åŠ¡ï¼Œæäº¤ç»™ IO è°ƒåº¦å™¨ã€‚

---

### æ¥æ”¶å¤±è´¥å¤„ç†

```cpp
        } else {
            SYLAR_LOG_ERROR(g_logger) << "accept errno=" << errno
                << " errstr=" << strerror(errno);
        }
```

* å¦‚æœ `accept()` è¿”å›å¤±è´¥ï¼Œä¼šè®°å½•é”™è¯¯æ—¥å¿—ã€‚
* `errno`ï¼šç³»ç»Ÿé”™è¯¯ç ã€‚
* `strerror(errno)`ï¼šå°†é”™è¯¯ç è½¬æ¢ä¸ºå¯è¯»å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ â€œConnection resetâ€ã€‚

---

### æ€»ç»“

è¿™ä¸ªå‡½æ•°çš„å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š

1. ä¸æ–­åœ¨ç›‘å¬ socket ä¸Šç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼ˆä½¿ç”¨ `accept()`ï¼‰ã€‚
2. æ¯å½“æˆåŠŸæ¥æ”¶åˆ°å®¢æˆ·ç«¯è¿æ¥ï¼š

   * ä¸ºå…¶è®¾ç½®è¶…æ—¶ï¼›
   * å°†è¿æ¥çš„å¤„ç†é€»è¾‘å°è£…ä¸ºä»»åŠ¡ï¼Œäº¤ç»™ `IOManager` å»å¼‚æ­¥è°ƒåº¦æ‰§è¡Œï¼›
3. å¦‚æœæ¥æ”¶å¤±è´¥ï¼Œè®°å½•é”™è¯¯æ—¥å¿—ã€‚


# `start()`


## ğŸ”§ å‡½æ•°å£°æ˜ä¸ä½œç”¨

```cpp
bool TcpServer::start()
```

* è¿™æ˜¯ `TcpServer` ç±»çš„æˆå‘˜å‡½æ•°ï¼Œç”¨äºå¯åŠ¨ TCP æœåŠ¡å™¨ã€‚
* å®ƒçš„ä»»åŠ¡æ˜¯ï¼š**å¯åŠ¨æ‰€æœ‰ç›‘å¬ socket çš„ accept é€»è¾‘**ï¼Œå³ç›‘å¬å®¢æˆ·ç«¯è¿æ¥å¹¶å¼€å§‹æ¥æ”¶ã€‚
* è¿”å›å€¼æ˜¯ `bool`ï¼Œè¡¨ç¤ºæ˜¯å¦å¯åŠ¨æˆåŠŸã€‚

---

## âœ… ç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨

```cpp
    if(!m_isStop) {
        return true;
    }
```

* `m_isStop` æ˜¯ `TcpServer` çš„æˆå‘˜å˜é‡ï¼Œç±»å‹æ˜¯ `bool`ï¼Œç”¨äºæ ‡è®°æœåŠ¡å™¨å½“å‰æ˜¯å¦æ˜¯â€œåœæ­¢çŠ¶æ€â€ã€‚
* å¦‚æœ `m_isStop == false`ï¼Œè¯´æ˜æœåŠ¡å™¨å·²ç»åœ¨è¿è¡Œï¼Œæ­¤æ—¶æ— éœ€é‡å¤å¯åŠ¨ï¼Œç›´æ¥ `return true;` è¡¨ç¤ºâ€œå¯åŠ¨æˆåŠŸâ€ï¼ˆè™½ç„¶å…¶å®ä»€ä¹ˆéƒ½æ²¡åšï¼‰ã€‚
* å¦åˆ™æ‰ä¼šç»§ç»­æ‰§è¡Œåç»­çš„å¯åŠ¨æµç¨‹ã€‚

---

## âœ… ç¬¬äºŒæ­¥ï¼šæ ‡è®°ä¸ºâ€œè¿è¡Œä¸­â€

```cpp
    m_isStop = false;
```

* å°† `m_isStop` è®¾ç½®ä¸º `false`ï¼Œè¡¨ç¤ºæœåŠ¡å™¨**ä»â€œåœæ­¢â€çŠ¶æ€åˆ‡æ¢ä¸ºâ€œè¿è¡Œâ€çŠ¶æ€**ã€‚

---

## âœ… ç¬¬ä¸‰æ­¥ï¼šè°ƒåº¦æ¯ä¸ªç›‘å¬ socket çš„ `startAccept` æ“ä½œ

```cpp
    for(auto& sock : m_socks) {
```

* `m_socks` æ˜¯ `TcpServer` çš„æˆå‘˜å˜é‡ï¼Œç±»å‹æ˜¯ `std::vector<Socket::ptr>`ï¼Œè¡¨ç¤ºå½“å‰æœåŠ¡å™¨çš„**æ‰€æœ‰ç›‘å¬ socket åˆ—è¡¨**ã€‚
* è¿™æ˜¯å› ä¸ºæ”¯æŒç»‘å®šå¤šä¸ª IP åœ°å€æˆ–ç«¯å£ï¼Œä¾‹å¦‚åŒæ—¶ç›‘å¬ `127.0.0.1:8080` å’Œ `192.168.1.1:8080`ã€‚
* ä½¿ç”¨ `range-based for` éå†æ‰€æœ‰ç›‘å¬ socketã€‚

---

```cpp
        m_acceptWorker->schedule(std::bind(&TcpServer::startAccept,
                    shared_from_this(), sock));
```

* `m_acceptWorker` æ˜¯ä¸€ä¸ª `IOManager::ptr`ï¼Œè¡¨ç¤º**æ¥æ”¶è¿æ¥çš„è°ƒåº¦å™¨çº¿ç¨‹æ± **ã€‚
* é€šè¿‡ `schedule()` å‘ `m_acceptWorker` æäº¤ä»»åŠ¡ï¼šå¯¹æ¯ä¸ª socket å¯åŠ¨ `startAccept()`ã€‚

#### ğŸ§  std::bind çš„ä½œç”¨ï¼š

```cpp
std::bind(&TcpServer::startAccept, shared_from_this(), sock)
```

ç­‰ä»·äºï¼š

```cpp
[this, sock]() {
    this->startAccept(sock);
}
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œç»‘å®šäº†å½“å‰æœåŠ¡å™¨å¯¹è±¡ï¼ˆ`shared_from_this()`ï¼‰å’Œå¯¹åº” socketï¼Œå½¢æˆä¸€ä¸ªä»»åŠ¡ä½“ï¼Œç”¨äºåç»­è°ƒåº¦ã€‚

è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š

* ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼›
* è®© `startAccept()` åœ¨çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼›
* æ¯ä¸ª socket çš„ accept é€»è¾‘ç‹¬ç«‹è¿è¡Œåœ¨ä¸åŒåç¨‹æˆ–çº¿ç¨‹ä¸­ã€‚

---

## âœ… ç¬¬å››æ­¥ï¼šè¿”å› true è¡¨ç¤ºæˆåŠŸ

```cpp
    return true;
```

æ— è®ºæ˜¯å• socket è¿˜æ˜¯å¤š socketï¼Œéƒ½è¿”å› `true`ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å·²ç»å¼€å§‹ç›‘å¬è¿æ¥ã€‚

---

## ğŸ” æ€»ç»“æµç¨‹

```cpp
if already running:
    return true;

set running state;
for each listening socket:
    schedule startAccept on acceptWorker;
return true;
```

æ¢å¥è¯è¯´ï¼š

1. å¦‚æœæœåŠ¡å™¨å·²ç»åœ¨è¿è¡Œï¼Œä»€ä¹ˆéƒ½ä¸åšã€‚
2. å¦åˆ™ï¼Œåˆ‡æ¢ä¸ºè¿è¡ŒçŠ¶æ€ã€‚
3. éå†æ‰€æœ‰ç›‘å¬çš„ socketï¼Œä¸ºæ¯ä¸€ä¸ª socket åœ¨ `m_acceptWorker` ä¸Šè°ƒåº¦ä¸€ä¸ª `startAccept()` åç¨‹æˆ–çº¿ç¨‹ã€‚
4. è¿”å›å¯åŠ¨æˆåŠŸã€‚

---

## ğŸ” å»¶ä¼¸è¯´æ˜ï¼šä¸ºä»€ä¹ˆä½¿ç”¨è°ƒåº¦å™¨ï¼Ÿ

* `startAccept()` æ˜¯ä¸€ä¸ª**é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥**çš„é€»è¾‘ï¼ˆè°ƒç”¨ `accept()`ï¼‰ï¼Œéœ€è¦æ”¾åœ¨çº¿ç¨‹æ± æˆ–åç¨‹ä¸­æ‰§è¡Œï¼›
* è¿™å°±æ˜¯ `m_acceptWorker->schedule()` çš„ä½œç”¨ â€”â€” **éé˜»å¡ä¸»çº¿ç¨‹**ï¼Œå¹¶å……åˆ†åˆ©ç”¨å¼‚æ­¥æ¨¡å‹ã€‚



