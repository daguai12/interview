å¥½é—®é¢˜ ğŸ‘
ä½ æåˆ°çš„ `alignas` **ä¸æ˜¯ GCC çš„ `__attribute__` æ‰©å±•**ï¼Œè€Œæ˜¯ **C++11 æ ‡å‡†å¼•å…¥çš„å…³é”®å­—**ï¼Œå’Œ `__attribute__((aligned))` åŠŸèƒ½ç±»ä¼¼ï¼Œä½†æ›´æ ‡å‡†åŒ–ã€å¯ç§»æ¤æ€§æ›´å¥½ã€‚

---

## ğŸ”¹ `alignas` çš„ä½œç”¨

`alignas` ç”¨æ¥**æŒ‡å®šå˜é‡ã€ç»“æ„ä½“ã€ç±»çš„å¯¹é½æ–¹å¼**ï¼Œå³å†…å­˜ä¸­åœ°å€å¿…é¡»æ˜¯æŒ‡å®šå­—èŠ‚æ•°çš„å€æ•°ã€‚

è¯­æ³•ï¼š

```cpp
alignas(N) type name;
```

å…¶ä¸­ `N` å¿…é¡»æ˜¯ 2 çš„å¹‚ï¼Œå¹¶ä¸” >= `alignof(type)`ã€‚

---

## ğŸ”¹ ç¤ºä¾‹

### 1. å¯¹å˜é‡æŒ‡å®šå¯¹é½

```cpp
#include <iostream>
#include <cstddef>  // for alignof

int main() {
    alignas(16) int x;  // x çš„åœ°å€ä¼šæ˜¯ 16 çš„å€æ•°
    std::cout << "alignof(x): " << alignof(decltype(x)) << '\n';
}
```

### 2. å¯¹ç»“æ„ä½“æŒ‡å®šå¯¹é½

```cpp
struct alignas(32) Vec4 {
    float x, y, z, w;
};
```

è¿™é‡Œ `Vec4` çš„å®ä¾‹ä¼šä»¥ 32 å­—èŠ‚å¯¹é½ï¼ˆå¸¸è§äº SIMD ä¼˜åŒ–ï¼‰ã€‚

### 3. æˆå‘˜å˜é‡æŒ‡å®šå¯¹é½

```cpp
struct Data {
    char c;
    alignas(8) int i;  // i ä¼šå•ç‹¬å¯¹é½åˆ° 8 å­—èŠ‚è¾¹ç•Œ
};
```

---

## ğŸ”¹ ä¸ `__attribute__((aligned(N)))` çš„åŒºåˆ«

| ç‰¹ç‚¹   | `alignas` (C++11 æ ‡å‡†)       | `__attribute__((aligned(N)))` (GCC æ‰©å±•) |
| ---- | -------------------------- | -------------------------------------- |
| å¯ç§»æ¤æ€§ | âœ… è·¨ç¼–è¯‘å™¨é€šç”¨ï¼ˆMSVC, GCC, Clangï¼‰ | âŒ ä»… GCC/Clang æ”¯æŒ                       |
| è¯­æ³•   | å…³é”®å­—ï¼ˆè¯­è¨€å†…ç½®ï¼‰                  | å‡½æ•°/å˜é‡/ç±»å‹æ‰©å±•                             |
| æ¨èåº¦  | âœ… æ¨èä¼˜å…ˆä½¿ç”¨                   | ä»…åœ¨å…¼å®¹æ—§ä»£ç /è·¨ C è¯­è¨€æ—¶ç”¨                       |

---

## ğŸ”¹ å¯¹æ¯”ç¤ºä¾‹

```cpp
// C++11 æ ‡å‡†å†™æ³•
alignas(16) int a;

// GCC æ‰©å±•å†™æ³•
int b __attribute__((aligned(16)));
```

æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œ`a` å’Œ `b` çš„åœ°å€éƒ½ä¼šæ˜¯ 16 çš„å€æ•°ã€‚

---

ğŸ‘‰ æ€»ç»“ï¼š
å¦‚æœä½ å†™çš„æ˜¯ **ç°ä»£ C++ (C++11 åŠä»¥å)**ï¼Œæ¨èç”¨ **`alignas`**ï¼›
å¦‚æœä½ å†™çš„æ˜¯ **C ä»£ç ** æˆ–éœ€è¦å…¼å®¹æ—§çš„ GCC-only ä»£ç ï¼Œé‚£å°±ç”¨ **`__attribute__((aligned))`**ã€‚

è¦ä¸è¦æˆ‘ç»™ä½ å†™ä¸€ä¸ª **åŒæ—¶å…¼å®¹ C å’Œ C++ çš„è·¨å¹³å°å¯¹é½å®**ï¼Ÿè¿™æ ·ä½ ä¸€ä¸ªå®èƒ½åŒæ—¶æ”¯æŒ `alignas`ï¼ˆåœ¨ C++11 åŠä»¥ä¸Šï¼‰å’Œ `__attribute__((aligned))`ï¼ˆåœ¨ C æˆ–è€ç¼–è¯‘å™¨é‡Œï¼‰ã€‚
