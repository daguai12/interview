`eventfd_write` 是 Linux 系统中用于向 `eventfd` 文件描述符写入事件计数的系统调用，用于触发事件通知。

### 函数作用
`eventfd` 内部维护一个 64 位无符号整数计数器，`eventfd_write` 的作用是将指定的数值 `num` 累加到该计数器中，从而触发事件通知（若有进程/线程正在等待该 `eventfd` 的读事件）。

### 代码解析
```c
auto ret = eventfd_write(m_efd, num);
```

- **参数**：
  - `m_efd`：通过 `eventfd()` 创建的 `eventfd` 文件描述符，即要写入的事件对象。
  - `num`：要累加的 64 位无符号整数（`uint64_t` 类型），表示事件发生的次数（通常设为 1 表示一次事件）。

- **返回值**：
  - 成功时返回 `0`，计数器会增加 `num` 的值。
  - 失败时返回 `-1`，并设置 `errno` 表示错误原因（如 `-EINVAL` 表示 `num` 为 0，`-EBADF` 表示文件描述符无效）。

### 工作机制
- 写入的 `num` 会被加到 `eventfd` 的计数器中（`counter += num`）。
- 若写入后计数器值大于 0，会唤醒所有阻塞在该 `eventfd` 上的读操作（如 `eventfd_read` 或 `epoll_wait`）。
- 若 `eventfd` 被设置为 `EFD_SEMAPHORE` 模式，计数器的值不会超过 1，多次写入会被合并（但通常不推荐在此模式下写入大于 1 的值）。

### 使用场景
`eventfd_write` 主要用于主动触发事件通知，常见场景包括：
1. 线程间通信：一个线程通过 `eventfd_write` 发送事件，另一个线程通过 `eventfd_read` 接收通知。
2. 配合 `io_uring`：虽然 `io_uring` 的 `eventfd` 通常由内核自动写入（当 CQ 有新事件时），但用户也可手动写入以触发自定义事件。
3. 作为事件循环的触发器：在事件驱动框架中，用于唤醒阻塞的事件循环处理新任务。

### 注意事项
- `num` 必须大于 0，否则会返回 `-1` 并设置 `errno = EINVAL`。
- 计数器是 64 位无符号整数，若累加后溢出（超过 `UINT64_MAX`），行为未定义（通常会回绕，但不推荐依赖此特性）。
- 若 `eventfd` 被设置为 `EFD_NONBLOCK` 模式，写入操作始终不会阻塞（只要参数有效就会成功）。

`eventfd_write` 是主动触发 `eventfd` 事件的核心接口，通过它可以灵活地在进程或线程间传递事件信号，是异步编程中实现高效通知机制的重要工具。